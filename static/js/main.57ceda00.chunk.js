(this["webpackJsonpbeer-fridge"]=this["webpackJsonpbeer-fridge"]||[]).push([[0],{156:function(e,t,n){},327:function(e,t,n){"use strict";n.r(t);var a=n(4),r=n(2),o=n.n(r),c=n(21),i=n.n(c),s=(n(156),n(23)),u=n(64),l=n.n(u),d=n(95),b=n(37),h=n(38),p=n(40),j=n(39),f=n(137),O=n.n(f),v=n(63),y=n(93),x=n.n(y),g=n(94),m=n.n(g),w=n(28),k=JSON.parse(JSON.stringify(m.a));k.palette.primary1Color=w.teal500,k.primary2Color=w.teal700,k.pickerHeaderColor=w.teal500;var C=x()(k),S=n(138),A=n.n(S),D=function(e){return Object(a.jsx)(A.a,Object(s.a)({showMenuIconButton:!1,title:"Beer Fridge"},e))},B=n(149),_=n(17),U=n(58),E=n.n(U),q=n(139),N=n.n(q),I=n(140),R=n.n(I),T=n(96),W=n.n(T),L=n(62),M=n.n(L),z=n(141),F=n.n(z),H=function(e){return Object(a.jsxs)(N.a,{iconStyle:e.iconStyle,iconButtonElement:Object(a.jsx)(M.a,{children:Object(a.jsx)(F.a,{})}),targetOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"top"},children:[Object(a.jsx)(W.a,{primaryText:e.displayName,disabled:!0}),Object(a.jsx)(R.a,{}),Object(a.jsx)(W.a,{primaryText:"Sign out",onClick:e.logout})]})},P=function(e){var t=e.user,n=e.authenticate,r=e.logout;return t?Object(a.jsx)(H,{iconStyle:{color:w.white},displayName:t.displayName,logout:r}):Object(a.jsx)(E.a,{labelStyle:{color:w.white},label:"Login",onClick:function(){return n("Google")}})},J=n(47),G=n(97),Q=n.n(G),V={chip:{margin:"0 0.5rem 0 0",display:"inline-block"},card:{height:"auto",width:"90%",maxWidth:"480px",margin:"1rem auto",display:"block"}},K=function(e){Object(p.a)(n,e);var t=Object(j.a)(n);function n(e){var r;return Object(b.a)(this,n),(r=t.call(this,e)).handleExpandChange=function(e){r.setState({expanded:e})},r.cardActions=function(){return r.props.user?Object(a.jsx)(E.a,{onClick:function(){return r.props.onConsumed(r.props.id,-1)},label:"\ud83c\udf7b Reduce Inventory"}):null},r.state={expanded:r.props.expanded||!1},r}return Object(h.a)(n,[{key:"render",value:function(){var e=this.props,t=e.beer,n=e.brewery,r=e.quantity;return Object(a.jsxs)(J.Card,{style:V.card,expanded:this.state.expanded,onExpandChange:this.handleExpandChange,children:[Object(a.jsx)(J.CardHeader,{title:t.beer_name,subtitle:r?"".concat(r," in stock"):null,avatar:t.beer_label,actAsExpander:!0,showExpandableButton:void 0===this.props.expandable||this.props.expandable}),Object(a.jsx)(J.CardTitle,{expandable:!0,title:null,subtitle:n.brewery_name}),Object(a.jsx)(J.CardText,{expandable:!0,children:t.beer_description}),Object(a.jsxs)(J.CardActions,{expandable:!0,children:[Object(a.jsx)(Q.a,{style:V.chip,children:t.beer_style}),Object(a.jsxs)(Q.a,{style:V.chip,children:[t.beer_abv," %"]})]}),Object(a.jsx)(J.CardActions,{children:this.cardActions()})]})}}]),n}(o.a.Component),Y=n(142),Z=n.n(Y),$={position:"absolute",top:"50%",left:"50%"},X=function(){return Object(a.jsx)(Z.a,{style:$})},ee=n(143),te=n.n(ee),ne=function(e){var t=e.isLoading,n=e.user,r=e.beers,o=e.updateInventory;return t?Object(a.jsx)(X,{}):r&&Object.keys(r).length?Object.keys(r).map((function(e){return Object(a.jsx)(K,Object(s.a)({id:e,user:n,onConsumed:function(){return o(e,-1)}},r[e]),e)})):Object(a.jsx)(te.a,{title:"No beers \ud83d\udeb1",actions:Object(a.jsx)(E.a,{onClick:function(){return window.location="/scan"},color:"primary",children:"Add a beer"}),open:!0,modal:!0,children:"No beers are in the fridge right now, check back later."})},ae=n(144),re=n.n(ae),oe=n(145),ce=n.n(oe),ie=n(98),se=n.n(ie),ue={marginRight:"0.5rem"},le=function(e){Object(p.a)(n,e);var t=Object(j.a)(n);function n(){var e;Object(b.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).accessToken="D57B2411FF9F7D458CDAEDF2BA97E27F37778A1B",e.quantityRef=o.a.createRef(),e.state={loaded:!1,beer:null,brewery:null,quantity:1},e.doCancel=function(t){t&&t.preventDefault(),e.props.history.push("/")},e.doSave=function(t){t.preventDefault(),e.props.save({beer:e.state.beer,brewery:e.state.brewery,quantity:parseInt(e.quantityRef.current.input.value,10)}),e.doCancel()},e}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.props.location.queryParams=re.a.parse(this.props.location.search),this.lookupBeer(this.props.location.queryParams.barcode)}},{key:"lookupBeer",value:function(e){var t=this,n="https://api.untappd.com/v4/beer/checkbarcodemultiple?upc=".concat(e,"&access_token=").concat(this.accessToken);fetch(n).then((function(e){return e.json()})).then((function(e){if(e.response&&e.response.items)return e.response.items[0]})).then((function(n){if(!n)throw new Error("".concat(e," was not found on Untappd!"));t.setState({loaded:!0,beer:n.beer,brewery:n.brewery})}))}},{key:"render",value:function(){var e=this;return this.state.loaded?Object(a.jsxs)("form",{onSubmit:function(t){return e.doSave(t)},children:[Object(a.jsx)(K,{beer:this.state.beer,brewery:this.state.brewery,expanded:!0,expandable:!1}),Object(a.jsxs)("div",{style:V.card,children:[Object(a.jsx)(ce.a,{floatingLabelText:"Quantity",defaultValue:this.state.quantity,ref:this.quantityRef,type:"number"}),Object(a.jsx)("br",{}),Object(a.jsx)(se.a,{style:ue,primary:!0,type:"submit",label:"Add this Beer"}),Object(a.jsx)(se.a,{style:ue,onClick:function(t){return e.doCancel(t)},label:"Cancel"})]})]}):Object(a.jsx)(X,{})}}]),n}(o.a.Component),de=n(70),be=n(48),he=n.n(be),pe=function(e){Object(p.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(b.a)(this,n),(a=t.call(this,e))._onDetected=a._onDetected.bind(Object(de.a)(a)),a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){he.a.init({inputStream:{type:"LiveStream",constraints:{width:1280,height:720,facingMode:"environment"}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader"]},locate:!0},(function(e){if(e)return console.log(e);var t=he.a.CameraAccess.getActiveTrack();"function"===typeof t.applyConstraints&&t.applyConstraints({advanced:[{torch:!0}]}),he.a.start()})),he.a.onDetected(this._onDetected)}},{key:"componentWillUnmount",value:function(){he.a.offDetected(this._onDetected)}},{key:"_onDetected",value:function(e){var t=e.codeResult.code;he.a.offDetected(this._onDetected),window.location="/checkin?barcode=".concat(t)}},{key:"render",value:function(){return Object(a.jsx)("div",{id:"interactive",className:"viewport"})}}]),n}(o.a.Component),je=n(146),fe=n.n(je),Oe=n(147),ve=n.n(Oe),ye=n(71),xe=n.n(ye),ge={position:"fixed",bottom:xe.a.desktopGutter,right:xe.a.desktopGutter,zIndex:100},me=function(e){return e.user?Object(a.jsx)(fe.a,Object(s.a)(Object(s.a)({},e),{},{style:ge,children:Object(a.jsx)(ve.a,{})})):null},we=n(148),ke=n.n(we),Ce=v.a.initializeApp({apiKey:"AIzaSyAYc_bUuVSffHfOUhOlLahHZCu54C8a_8U",databaseURL:"https://sudojosh-beer-fridge.firebaseio.com",authDomain:"sudojosh-beer-fridge.firebaseapp.com"}),Se=ke.a.createClass(Ce.database()),Ae=function(e){Object(p.a)(n,e);var t=Object(j.a)(n);function n(){var e;Object(b.a)(this,n);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).state={beers:{},loading:!0,currentUser:null},e.authHandler=function(){var t=Object(d.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({currentUser:n.user});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.updateInventory=function(t,n){var a=Object(s.a)({},e.state.beers),r=a[t];r&&(r.quantity=(r.quantity||0)+n,r.quantity<1&&(a[t]=null),e.setState({beers:a}))},e.authenticate=function(t){var n=new(v.a.auth["".concat(t,"AuthProvider")]);Ce.auth().signInWithPopup(n).then(e.authHandler)},e.logout=Object(d.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.a.auth().signOut();case 2:e.setState({currentUser:null});case 3:case"end":return t.stop()}}),t)}))),e.scanBarcode=function(){var e="http://".concat(window.location.host,"/checkin?barcode={CODE}"),t="zxing://scan/?ret=".concat(encodeURIComponent(e),"&SCAN_FORMATS=EAN_13,UPC_A");window.location=t},e.addOrUpdateBeer=function(t){var n=Object(s.a)({},e.state.beers),a=n[t.beer.bid];a&&(a.quantity+=t.quantity),n[t.beer.bid]=a||t,e.setState({beers:n})},e.BeerManagement=function(){return Object(a.jsxs)("div",{children:[Object(a.jsx)(me,{user:e.state.currentUser,onClick:function(){return window.location="/scan"}}),Object(a.jsx)(ne,{updateInventory:e.updateInventory,user:e.state.currentUser,scanNew:e.scanBarCode,isLoading:e.state.loading,beers:e.state.beers})]})},e}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.ref=Se.syncState("/beers",{context:this,state:"beers",then:function(){return e.setState({loading:!1})}}),Ce.auth().onAuthStateChanged((function(t){return e.authHandler({user:t})}))}},{key:"componentWillUnmount",value:function(){Se.removeBinding(this.ref)}},{key:"render",value:function(){var e=this;return Object(a.jsx)(O.a,{muiTheme:C,children:Object(a.jsx)(B.a,{basename:"",children:Object(a.jsxs)("div",{children:[Object(a.jsx)(D,{iconElementRight:Object(a.jsx)(P,{authenticate:this.authenticate,logout:this.logout,user:this.state.currentUser})}),Object(a.jsx)(_.a,{exact:!0,path:"/",render:this.BeerManagement}),Object(a.jsx)(_.a,{path:"/scan",render:function(e){return Object(a.jsx)(pe,Object(s.a)({},e))}}),Object(a.jsx)(_.a,{path:"/checkin",render:function(t){return Object(a.jsx)(le,Object(s.a)(Object(s.a)({},t),{},{save:e.addOrUpdateBeer}))}})]})})})}}]),n}(r.Component),De=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Be(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(Object(a.jsx)(Ae,{}),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("","/service-worker.js");De?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Be(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):Be(e)}))}}()}},[[327,1,2]]]);
//# sourceMappingURL=main.57ceda00.chunk.js.map